{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { config } from '../config/Config';\nimport { handleResponse } from './HandleResponseSevice';\nimport axios from 'axios';\nconst currentUserSubject = new BehaviorSubject(JSON.parse(localStorage.getItem('currentUser')));\nexport const authenticationService = {\n  register,\n  login,\n  logout,\n  currentUser: currentUserSubject.asObservable(),\n\n  get currentUserValue() {\n    return currentUserSubject.value;\n  }\n\n};\n\nfunction register(user) {\n  return axios.post(config.apiUrl + 'auth/register', user).then(handleResponse).then(respose => {}).catch(err => {\n    console.log(err);\n  });\n}\n\nfunction login(user) {\n  return axios.post(config.apiUrl + 'auth/login/', user).then(handleResponse).then(respose => {\n    localStorage.setItem('currentUser', JSON.stringify(respose.success.token));\n    currentUserSubject.next(respose.success.token);\n\n    window.onbeforeunload = function () {\n      localStorage.removeItem('currentUser');\n      return '';\n    };\n\n    return respose;\n  }).catch(err => {\n    alert(\"login error\");\n    console.log(err);\n  });\n}\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem('currentUser');\n  currentUserSubject.next(null);\n}","map":{"version":3,"sources":["C:\\Users\\Administrator\\Documents\\E-Capil\\capil-web\\src\\service\\AutenticationService.js"],"names":["BehaviorSubject","config","handleResponse","axios","currentUserSubject","JSON","parse","localStorage","getItem","authenticationService","register","login","logout","currentUser","asObservable","currentUserValue","value","user","post","apiUrl","then","respose","catch","err","console","log","setItem","stringify","success","token","next","window","onbeforeunload","removeItem","alert"],"mappings":"AAAA,SAASA,eAAT,QAAgC,MAAhC;AAEA,SAAQC,MAAR,QAAqB,kBAArB;AACA,SAASC,cAAT,QAA+B,wBAA/B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,MAAMC,kBAAkB,GAAG,IAAIJ,eAAJ,CAAoBK,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,CAApB,CAA3B;AAEA,OAAO,MAAMC,qBAAqB,GAAG;AACjCC,EAAAA,QADiC;AAEjCC,EAAAA,KAFiC;AAGjCC,EAAAA,MAHiC;AAIjCC,EAAAA,WAAW,EAAET,kBAAkB,CAACU,YAAnB,EAJoB;;AAKjC,MAAIC,gBAAJ,GAAwB;AAAE,WAAOX,kBAAkB,CAACY,KAA1B;AAAiC;;AAL1B,CAA9B;;AAQP,SAASN,QAAT,CAAkBO,IAAlB,EAAuB;AACnB,SAAOd,KAAK,CAACe,IAAN,CAAWjB,MAAM,CAACkB,MAAP,GAAc,eAAzB,EAA0CF,IAA1C,EACNG,IADM,CACDlB,cADC,EACekB,IADf,CACoBC,OAAO,IAAI,CACrC,CAFM,EAEJC,KAFI,CAEEC,GAAG,IAAI;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GAJM,CAAP;AAKH;;AAED,SAASZ,KAAT,CAAeM,IAAf,EAAqB;AACjB,SAAOd,KAAK,CAACe,IAAN,CAAWjB,MAAM,CAACkB,MAAP,GAAc,aAAzB,EAAwCF,IAAxC,EACNG,IADM,CACDlB,cADC,EACekB,IADf,CACoBC,OAAO,IAAI;AAClCd,IAAAA,YAAY,CAACmB,OAAb,CAAqB,aAArB,EAAoCrB,IAAI,CAACsB,SAAL,CAAeN,OAAO,CAACO,OAAR,CAAgBC,KAA/B,CAApC;AACAzB,IAAAA,kBAAkB,CAAC0B,IAAnB,CAAwBT,OAAO,CAACO,OAAR,CAAgBC,KAAxC;;AACAE,IAAAA,MAAM,CAACC,cAAP,GAAwB,YAAW;AAC/BzB,MAAAA,YAAY,CAAC0B,UAAb,CAAwB,aAAxB;AACA,aAAO,EAAP;AACH,KAHD;;AAIA,WAAOZ,OAAP;AACH,GATM,EASJC,KATI,CASEC,GAAG,IAAI;AACZW,IAAAA,KAAK,CAAC,aAAD,CAAL;AACAV,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GAZM,CAAP;AAaH;;AAED,SAASX,MAAT,GAAkB;AACd;AACAL,EAAAA,YAAY,CAAC0B,UAAb,CAAwB,aAAxB;AACA7B,EAAAA,kBAAkB,CAAC0B,IAAnB,CAAwB,IAAxB;AACH","sourcesContent":["import { BehaviorSubject } from 'rxjs';\r\n\r\nimport {config} from '../config/Config';\r\nimport { handleResponse } from './HandleResponseSevice';\r\nimport axios from 'axios';\r\n\r\nconst currentUserSubject = new BehaviorSubject(JSON.parse(localStorage.getItem('currentUser')));\r\n\r\nexport const authenticationService = {\r\n    register,\r\n    login,\r\n    logout,\r\n    currentUser: currentUserSubject.asObservable(),\r\n    get currentUserValue () { return currentUserSubject.value }\r\n};\r\n\r\nfunction register(user){\r\n    return axios.post(config.apiUrl+'auth/register', user)\r\n    .then(handleResponse).then(respose => {\r\n    }).catch(err => {\r\n        console.log(err);\r\n    });\r\n}\r\n\r\nfunction login(user) {\r\n    return axios.post(config.apiUrl+'auth/login/', user)\r\n    .then(handleResponse).then(respose => {\r\n        localStorage.setItem('currentUser', JSON.stringify(respose.success.token));\r\n        currentUserSubject.next(respose.success.token);\r\n        window.onbeforeunload = function() {\r\n            localStorage.removeItem('currentUser');\r\n            return '';\r\n        };\r\n        return respose;\r\n    }).catch(err => {\r\n        alert(\"login error\");\r\n        console.log(err);\r\n    });\r\n}\r\n\r\nfunction logout() {\r\n    // remove user from local storage to log user out\r\n    localStorage.removeItem('currentUser');\r\n    currentUserSubject.next(null);\r\n}"]},"metadata":{},"sourceType":"module"}