{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { config } from '../config/Config';\nimport { handleResponse } from './HandleResponseSevice';\nimport axios from 'axios';\nconst currentUserSubject = new BehaviorSubject(JSON.parse(localStorage.getItem('currentUser')));\nexport const authenticationService = {\n  register,\n  login,\n  logout,\n  currentUser: currentUserSubject.asObservable(),\n\n  get currentUserValue() {\n    return currentUserSubject.value;\n  }\n\n};\n\nfunction register(user) {\n  return axios.post(config.apiUrl + 'auth/register', user).then(handleResponse).then(respose => {}).catch(err => {\n    console.log(err);\n  });\n}\n\nfunction login(user) {\n  return axios.post(config.apiUrl + 'auth/login/', user).then(handleResponse).then(respose => {\n    if (user.rememberme) {\n      localStorage.setItem('currentUser', JSON.stringify(respose.success.token));\n    } else {\n      sessionStorage.setItem('currentUser', JSON.stringify(respose.success.token));\n    }\n\n    currentUserSubject.next(respose.success.token);\n    return respose;\n  }).catch(err => {\n    alert(\"login error\");\n    console.log(err);\n  });\n}\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem('currentUser');\n  sessionStorage.removeItem('currentUser');\n  currentUserSubject.next(null);\n}","map":{"version":3,"sources":["C:\\Users\\Administrator\\Documents\\E-Capil\\capil-web\\src\\service\\AutenticationService.js"],"names":["BehaviorSubject","config","handleResponse","axios","currentUserSubject","JSON","parse","localStorage","getItem","authenticationService","register","login","logout","currentUser","asObservable","currentUserValue","value","user","post","apiUrl","then","respose","catch","err","console","log","rememberme","setItem","stringify","success","token","sessionStorage","next","alert","removeItem"],"mappings":"AAAA,SAASA,eAAT,QAAgC,MAAhC;AAEA,SAAQC,MAAR,QAAqB,kBAArB;AACA,SAASC,cAAT,QAA+B,wBAA/B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,MAAMC,kBAAkB,GAAG,IAAIJ,eAAJ,CAAoBK,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,CAApB,CAA3B;AAEA,OAAO,MAAMC,qBAAqB,GAAG;AACjCC,EAAAA,QADiC;AAEjCC,EAAAA,KAFiC;AAGjCC,EAAAA,MAHiC;AAIjCC,EAAAA,WAAW,EAAET,kBAAkB,CAACU,YAAnB,EAJoB;;AAKjC,MAAIC,gBAAJ,GAAwB;AAAE,WAAOX,kBAAkB,CAACY,KAA1B;AAAiC;;AAL1B,CAA9B;;AAQP,SAASN,QAAT,CAAkBO,IAAlB,EAAuB;AACnB,SAAOd,KAAK,CAACe,IAAN,CAAWjB,MAAM,CAACkB,MAAP,GAAc,eAAzB,EAA0CF,IAA1C,EACNG,IADM,CACDlB,cADC,EACekB,IADf,CACoBC,OAAO,IAAI,CACrC,CAFM,EAEJC,KAFI,CAEEC,GAAG,IAAI;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GAJM,CAAP;AAKH;;AAED,SAASZ,KAAT,CAAeM,IAAf,EAAqB;AACjB,SAAOd,KAAK,CAACe,IAAN,CAAWjB,MAAM,CAACkB,MAAP,GAAc,aAAzB,EAAwCF,IAAxC,EACNG,IADM,CACDlB,cADC,EACekB,IADf,CACoBC,OAAO,IAAI;AAClC,QAAGJ,IAAI,CAACS,UAAR,EAAmB;AACfnB,MAAAA,YAAY,CAACoB,OAAb,CAAqB,aAArB,EAAoCtB,IAAI,CAACuB,SAAL,CAAeP,OAAO,CAACQ,OAAR,CAAgBC,KAA/B,CAApC;AACH,KAFD,MAEK;AACDC,MAAAA,cAAc,CAACJ,OAAf,CAAuB,aAAvB,EAAsCtB,IAAI,CAACuB,SAAL,CAAeP,OAAO,CAACQ,OAAR,CAAgBC,KAA/B,CAAtC;AACH;;AACD1B,IAAAA,kBAAkB,CAAC4B,IAAnB,CAAwBX,OAAO,CAACQ,OAAR,CAAgBC,KAAxC;AAGA,WAAOT,OAAP;AACH,GAXM,EAWJC,KAXI,CAWEC,GAAG,IAAI;AACZU,IAAAA,KAAK,CAAC,aAAD,CAAL;AACAT,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GAdM,CAAP;AAeH;;AAED,SAASX,MAAT,GAAkB;AACd;AACAL,EAAAA,YAAY,CAAC2B,UAAb,CAAwB,aAAxB;AACAH,EAAAA,cAAc,CAACG,UAAf,CAA0B,aAA1B;AACA9B,EAAAA,kBAAkB,CAAC4B,IAAnB,CAAwB,IAAxB;AACH","sourcesContent":["import { BehaviorSubject } from 'rxjs';\r\n\r\nimport {config} from '../config/Config';\r\nimport { handleResponse } from './HandleResponseSevice';\r\nimport axios from 'axios';\r\n\r\nconst currentUserSubject = new BehaviorSubject(JSON.parse(localStorage.getItem('currentUser')));\r\n\r\nexport const authenticationService = {\r\n    register,\r\n    login,\r\n    logout,\r\n    currentUser: currentUserSubject.asObservable(),\r\n    get currentUserValue () { return currentUserSubject.value }\r\n};\r\n\r\nfunction register(user){\r\n    return axios.post(config.apiUrl+'auth/register', user)\r\n    .then(handleResponse).then(respose => {\r\n    }).catch(err => {\r\n        console.log(err);\r\n    });\r\n}\r\n\r\nfunction login(user) {\r\n    return axios.post(config.apiUrl+'auth/login/', user)\r\n    .then(handleResponse).then(respose => {\r\n        if(user.rememberme){\r\n            localStorage.setItem('currentUser', JSON.stringify(respose.success.token));\r\n        }else{\r\n            sessionStorage.setItem('currentUser', JSON.stringify(respose.success.token));\r\n        }\r\n        currentUserSubject.next(respose.success.token);\r\n\r\n        \r\n        return respose;\r\n    }).catch(err => {\r\n        alert(\"login error\");\r\n        console.log(err);\r\n    });\r\n}\r\n\r\nfunction logout() {\r\n    // remove user from local storage to log user out\r\n    localStorage.removeItem('currentUser');            \r\n    sessionStorage.removeItem('currentUser');\r\n    currentUserSubject.next(null);\r\n}"]},"metadata":{},"sourceType":"module"}